<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Tool to create music box sheets from midi by converting them to a laser cutter file.">
    <meta name="author" content="">
    <link rel="shortcut icon" href="favicon.ico">

    <title>Midi to lasercutter</title>

    <!-- Bootstrap Core CSS -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">

    <!-- Select element CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.2/css/bootstrap-select.min.css">
    <link rel="stylesheet" href="inc/custom.css">
   

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">Wintergatan midi to lasercutter</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#helpModal">How to use</a>
                    </li>
                    <li>
                        <a href="#" data-toggle="modal" data-target="#aboutModal">About</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>


    <!-- Page Content -->
    <div class="container">
        <div class="row">

            <div class="col-md-4">
                <div class="form-group">
                    <label for="units">Units</label>
                    <select id="units" class="selectpicker form-control">
                        <option>Millimeters</option>
                        <option>Inches</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="workpiece-width">Workpiece width</label>
                    <div class="input-group">
                        <input type="number" class="form-control" id="workpiece-width" min="0" step="1" max="10000">
                        <span class="input-group-addon unit-suffix">mm</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="workpiece-height">Workpiece height</label>
                    <div class="input-group">
                        <input type="number" class="form-control" id="workpiece-height" min="0" step="1" max="10000">
                        <span class="input-group-addon unit-suffix">mm</span>
                    </div>
                </div>

            </div>

            <div class="col-md-4">
                <div class="form-group">
                    <label for="starting-edge">Starting edge</label>
                    <select id="starting-edge" class="selectpicker form-control">
                        <option>Straight</option>
                        <option>Diagonal</option>
                        <option>Jagged</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="joint-edge">Joint edge</label>
                    <select id="joint-edge" class="selectpicker form-control">
                        <option>Straight</option>
                        <option>Diagonal</option>
                        <option>Jagged</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="ending-edge">Ending edge</label>
                    <select id="ending-edge" class="selectpicker form-control">
                        <option>Straight</option>
                        <option>Diagonal</option>
                        <option>Jagged</option>
                    </select>
                </div>
            </div>

            <div class="col-md-4">
                <div class="form-group">
                    <label for="hole-shape">Hole shape</label>
                    <select id="hole-shape" class="selectpicker form-control">
                        <option>Rounded</option>
                        <option>Square</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="hole-width">Hole width</label>
                    <div class="input-group">
                        <input type="number" class="form-control" id="hole-width" value="2" min="0" step="1" max="10000">
                        <span class="input-group-addon unit-suffix">mm</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="hole-height">Hole height</label>
                    <div class="input-group">
                        <input type="number" class="form-control" id="hole-height" value="1.5" min="0" step="1" max="10000">
                        <span class="input-group-addon unit-suffix">mm</span>
                    </div>
                </div>
            </div>

        </div>
        <!-- /.row -->

        <div class="row">
            <div class="col-md-4">
				<div class="form-group">
                    <label for="strip-height">Strip height</label>
                    <div class="input-group">
                        <input type="number" class="form-control" id="strip-height" value="70" min="0" step="1" max="10000">
                        <span class="input-group-addon unit-suffix">mm</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="scale">Scale</label>
                    <select id="scale" class="selectpicker form-control">
                        <option>C</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="scale-type">Scale type</label>
                    <select id="scale-type" class="selectpicker form-control">
                        <option>Major</option>
                    </select>
                </div>
            </div>

            <div class="col-md-4">
                <div class="form-group">
                    <label for="amount-of-pins">Amount of pins</label>
                    <input type="number" class="form-control" id="amount-of-pins" value="20" min="0" step="1" max="10000">
                </div>
                <div class="form-group">
                    <label for="file-picker-midi">Midi file</label>
                    <div class="input-group">
                        <label class="input-group-btn">
                        <span class="btn btn-default">
                            Browse <input id="file-picker-midi" style="display: none;" type="file" accept=".midi,.mid">
                        </span>
                    </label>
                        <input id="midi-file" class="form-control" readonly type="text">
                    </div>
                </div>
                <div class="form-group">
                    <label for="current-scale">Current scale</label>
                    <input type="text" class="form-control" id="current-scale" value="C D E F G A B" readonly>
                </div>
            </div>

            <div class="col-md-4">
                <div class="form-group">
                    <label for="horizontal-margins">Horizontal margins</label>
                    <div class="input-group">
                        <input type="number" class="form-control" id="horizontal-margins" value="50" min="0" step="1" max="10000">
                        <span class="input-group-addon unit-suffix">mm</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="vertical-margins">Vertical margins</label>
                    <div class="input-group">
                        <input type="number" class="form-control" id="vertical-margins" value="6.5" min="0" step="1" max="10000">
                        <span class="input-group-addon unit-suffix">mm</span>
                    </div>
                </div>

                <button type="button" id="import-settings" class="btn btn-default">Import settings</button>
                <input id="file-picker-import-settings" style="display: none;" type="file">

                <button type="button" id="export-settings" class="btn btn-default pull-right">Export settings</button>
            </div>
        </div>
        <!-- /.row -->

        <div class="row">
            <div class="col-md-4 col-md-offset-4 text-center">
                <button type="button" id="show-preview" class="btn btn-primary">Show Preview</button>
            </div>
        </div>

        <div class="row">
            <div class="text-center" id="preview-box" style="width:100%;height:300px;border:0;margin-top:20px;overflow-x:scroll;"></div>
        </div>

        <div id="export-row" class="row">
            <div class="col-md-4">
                <div class="form-group">
                    <label for="export-format">Export format</label>
                    <select id="export-format" class="selectpicker form-control">
                        <option value="svg">SVG</option>
                        <option value="dxf">DXF</option>
						<option value="txt">Plain Text</option>
                    </select>
                </div>
            </div>

            <div class="col-md-4">
                <div class="form-group">
                    <label for="line-color">Line color</label>
                    <div class="input-group">
                        <input type="color" class="form-control" id="line-color" value="#FF0000">
                        <span id="color-suffix" class="input-group-addon">#FF0000</span>
                    </div>
                </div>
            </div>

            <div class="col-md-4 text-center">
                <button type="button" id="download-btn" class="btn btn-primary" disabled>Download Laser Cutter plans</button>
            </div>
        </div>

    </div>
    <!-- /.container -->


    <div class="modal fade" id="aboutModal" tabindex="-1" role="dialog" aria-labelledby="aboutModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="aboutModalLabel">About</h4>
          </div>
          <div class="modal-body">
            This tool automates the process of turning MIDI files into printable or cuttable music box paper tape.
            It was inspired by this <a href="https://www.youtube.com/watch?v=HjBhO9iqEc0" target="_blank">Music Box Hole Punch Tutorial</a> made by Martin Molin of Swedish band Wintergatan. In the video, he describes the tedious process of creating the paper tape for music boxes by hand and reaches out to the coding world for a more automated solution.
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="helpModal" tabindex="-1" role="dialog" aria-labelledby="helpModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="helpModalLabel">How To Use</h4>

            <p>The application accepts a MIDI file and user settings as input. It then generates an output file in either SVG, DXF or plain text format. The generated output file can be printed or used in a laser-cutter.</p>

            <table class="table">
                <tr>
                    <th>Units</th>
                    <td>Select inches or millimeters for all numerical measurement settings</td>
                </tr>
                <tr>
                    <th>Workpiece width</th>
                    <td>Width of workpiece (not currently used)</td>
                </tr>
                <tr>
                    <th>Workpiece height</th>
                    <td>Height of workpiece (not currently used)</td>
                </tr>
                <tr>
                    <th>Strip height</th>
                    <td>Height of the paper strip</td>
                </tr>
                <tr>
                    <th>Scale</th>
                    <td>Currently limited to Key of C</td>
                </tr>
                <tr>
                    <th>Scale type</th>
                    <td>Currently limited to Major Scale</td>
                </tr>
                <tr>
                    <th>Starting edge</th>
                    <td>The starting edge shape: straight, diagonal or jagged</td>
                </tr>
                <tr>
                    <th>Joint edge</th>
                    <td>Edge shape to be used between sections: straight, diagonal or jagged</td>
                </tr>
                <tr>
                    <th>Ending edge</th>
                    <td>Ending edge shape: straight, diagonal or jagged</td>
                </tr>
                <tr>
                    <th>Amount of pins</th>
                    <td>Number of pins on music box or device</td>
                </tr>
                <tr>
                    <th>Midi file</th>
                    <td>A valid MIDI file is required</td>
                </tr>
                <tr>
                    <th>Current scale</th>
                    <td>Current scale used in the generation (Read-only)</td>
                </tr>
                <tr>
                    <th>Hole shape</th>
                    <td>Corner type for punch holes: Rounded or Square</td>
                </tr>
                <tr>
                    <th>Hole width</th>
                    <td>Width of punch holes</td>
                </tr>
                <tr>
                    <th>Hole height</th>
                    <td>Height of punch holes</td>
                </tr>
                <tr>
                    <th>Horizontal margins</th>
                    <td>Left and right margins</td>
                </tr>
                <tr>
                    <th>Vertical margins</th>
                    <td>Top and bottom margins</td>
                </tr>
                <tr>
                    <th>Import settings</th>
                    <td>Import previously saved settings in JSON format. This will overwrite the current configuration.
                        Current MIDI file will not be affected.</td>
                </tr>
                <tr>
                    <th>Export settings</th>
                    <td>Export current settings in JSON format. Does not include MIDI file.</td>
                </tr>
                <tr>
                    <th>Export format</th>
                    <td>Format for your output: SVG, DXF or Plain Text</td>
                </tr>
                <tr>
                    <th>Line color</th>
                    <td>Color of track lines in output file</td>
                </tr>
                <tr>
                    <th>Show Preview</th>
                    <td>Generate and display an on-screen, scrollable preview using the current settings</td>
                </tr>
                <tr>
                    <th>Download Laser Cutter Plans</th>
                    <td>Generate and save an output file in the specified format</td>
                </tr>
            </table>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <!-- jQuery Version 3.2.1 -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <!-- Bootstrap select -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.2/js/bootstrap-select.min.js"></script>

    <script type="text/javascript">
        if (!Array.prototype.find) {
            Object.defineProperty(Array.prototype, "find", {
                value: function (predicate) {
                    if (this === null) {
                        throw new TypeError('Array.prototype.find called on null or undefined');
                    }
                    if (typeof predicate !== 'function') {
                        throw new TypeError('predicate must be a function');
                    }
                    var list = Object(this);
                    var length = list.length >>> 0;
                    var thisArg = arguments[1];
                    var value;

                    for (var i = 0; i < length; i++) {
                        value = list[i];
                        if (predicate.call(thisArg, value, i, list)) {
                            return value;
                        }
                    }
                    return undefined;
                }
            });
        }

        function compare(a, b) {
            if (a > b) return 1;
            if (a < b) return -1;
            return 0;
        }
    </script>
    <script src="inc/user-interface.js"></script>
    <script src="inc/midi-parser.js"></script>
    <script src="inc/maker.js"></script>
    <script src="inc/scaleandmusicbox.js"></script>
    <script src="inc/processing.js"></script>
    <script src="inc/drawing.js"></script>
</body>

</html>